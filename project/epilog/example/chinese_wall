/*
 * Chinese-Wall Policy Example
 * Vino Crescini  <jcrescin@cit.uws.edu.au>
 */

ident sub S;
ident acc Access, Accessible;
ident obj Object1, Object2;
ident obj-grp Company1, Company2;

/* initial facts */

initially 
  memb(Object1, Company1) &&
  memb(Object2, Company2);
initially 
  holds(S, Accessible, Company1) &&
  holds(S, Accessible, Company2);

/* transformations */

Request_Access_Company1(X, Y)
  causes
    holds(X, Access, Y) &&
    !holds(X, Accessible, Company2)
  if
    memb(Y, Company1) &&
    holds(X, Accessible, Company1);

Request_Access_Company2(X, Y)
  causes
    holds(X, Access, Y) &&
    !holds(X, Accessible, Company1)
  if
    memb(Y, Company2) &&
    holds(X, Accessible, Company2);

/* queries */

query holds(S, Accessible, Object2) after Request_Access_Company1(S, Object1);
query holds(S, Accessible, Object1) after Request_Access_Company2(S, Object2);
