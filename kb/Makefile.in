# Vino Crescini <jcrescin@cit.uws.edu.au>

TOPSRCDIR = @top_srcdir@
DISTDIR = @DISTDIR@
CURDIR = kb
CC = @CC@
CXX = @CXX@
LEX = @LEX@
YACC = @YACC@
CFLAGS = @CFLAGS@
CXXFLAGS = @CXXFLAGS@
LN_S = @LN_S@
SMODELS = @SMODELS@

ifdef SMODELS
SMINCLUDES = wrapper.h
SMOBJECTS = wrapper.o
endif

BINS =
LIBS = libkb.a
INCLUDES = atom.h expression.h seqtab.h symtab.h consttab.h transtab.h $(SMINCLUDES) kb.h
OBJECTS = atom.o expression.o seqtab.o symtab.o consttab.o transtab.o $(SMOBJECTS) kb.o

include $(TOPSRCDIR)/rules.mk

libkb.a : $(OBJECTS)
	$(AR) -rcs $(@) $(OBJECTS)

atom.o : atom.h atom.cpp
	$(CXX) $(CXXFLAGS) -o $(@) -c atom.cpp

expression.o : atom.o expression.h expression.cpp
	$(CXX) $(CXXFLAGS) -o $(@) -c expression.cpp

seqtab.o : seqtab.h seqtab.cpp
	$(CXX) $(CXXFLAGS) -o $(@) -c seqtab.cpp

symtab.o : symtab.h symtab.cpp
	$(CXX) $(CXXFLAGS) -o $(@) -c symtab.cpp

consttab.o : expression.o consttab.h consttab.cpp
	$(CXX) $(CXXFLAGS) -o $(@) -c consttab.cpp

transtab.o : expression.o transtab.h transtab.cpp
	$(CXX) $(CXXFLAGS) -o $(@) -c transtab.cpp

ifdef SMODELS
wrapper.o : wrapper.h wrapper.cpp
	$(CXX) $(CXXFLAGS) -o $(@) -c wrapper.cpp
endif

kb.o : expression.o symtab.o consttab.o transtab.o $(SM_OBJECTS) kb.h kb.cpp
	$(CXX) $(CXXFLAGS) -o $(@) -c kb.cpp
