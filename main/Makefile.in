# Vino Crescini <jcrescin@cit.uws.edu.au>

TOPSRCDIR = @top_srcdir@
DISTDIR = @DISTDIR@
BINDIR = @BINDIR@
INCLUDEDIR = @INCLUDEDIR@
LIBDIR = @LIBDIR@
CC = @CC@
CXX = @CXX@
LEX = @LEX@
YACC = @YACC@
LEXLIB = @LEXLIB@
CFLAGS = @CFLAGS@
CXXFLAGS = @CXXFLAGS@
LDFLAGS = @LDFLAGS@
DEBUG = @DEBUG@
STRIP = @STRIP@
TARGETS = vlad

all : $(TARGETS)
	@mkdir -p $(BINDIR)
	@for i in $(TARGETS); do \
	ln -sf ../../main/$$i $(BINDIR); \
	done

vlad : vlad.o $(LIBDIR)/*
	$(CXX) $(LDFLAGS) -o $(@) vlad.o -lparser -lkb -lcommon $(LEXLIB)
ifndef DEBUG
  ifdef STRIP
	strip $(@)
  endif
endif

vlad.o : vlad.cpp
	$(CXX) $(CXXFLAGS) -o $(@) -c vlad.cpp

clean :
	$(RM) *.o

distclean : clean
	$(RM) $(TARGETS) Makefile
	@for i in $(TARGETS); do \
	$(RM) $(BINDIR)/$$i; \
	done
